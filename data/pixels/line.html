<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="style.css" rel="stylesheet" />
    <script>
      function openTab(evt, tabName) {
        let command = evt.currentTarget.getAttribute("data-program");
        const tabcontent = document.getElementsByClassName("tabcontent");
        for (let i = 0; i < tabcontent.length; i++) {
          tabcontent[i].style.display = "none";
        }
        const tablinks = document.getElementsByClassName("tablinks");
        for (let i = 0; i < tablinks.length; i++) {
          tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";

        if (command) {
          pixels.sendCommand(command);
        }
      }
    </script>
  </head>

  <body style="zoom: 1.5">
    <div class="tab">
      <button
        data-program="BD11"
        class="tablinks"
        onclick="openTab(event, 'LineMode')"
      >
        Line mode
      </button>
      <button
        class="tablinks"
        data-program="BD1"
        onclick="openTab(event, 'RainMode')"
      >
        Rain mode
      </button>
      <button
        class="tablinks"
        data-program="BD3"
        onclick="openTab(event, 'CometMode')"
      >
        Comet mode
      </button>
      <button class="tablinks" onclick="openTab(event, 'Disco')" data-only-http>
        Disco
      </button>
      <button
        class="tablinks"
        onclick="openTab(event, 'Advanced')"
        data-only-http
      >
        Advanced
      </button>
    </div>

    <div id="LineMode" class="tabcontent">
      <h1>Select a predefined color model</h1>
      <div class="flex flex-wrap" id="models"></div>

      <div data-only-http>
        <h1>Customize the colors</h1>
        <div>
          <span style="width: 50px">&nbsp;Change all colors at once:</span>
          <input
            type="color"
            data-label="BP,BQ,BR,BS,BV,BW,BX,BY"
            style="width: 25px"
          />
        </div>
        or select individually the 8 colors:
        <input type="color" data-label="BP" style="width: 25px" />
        <input type="color" data-label="BQ" style="width: 25px" />
        <input type="color" data-label="BR" style="width: 25px" />
        <input type="color" data-label="BS" style="width: 25px" />
        <input type="color" data-label="BV" style="width: 25px" />
        <input type="color" data-label="BW" style="width: 25px" />
        <input type="color" data-label="BX" style="width: 25px" />
        <input type="color" data-label="BY" style="width: 25px" />
      </div>

      <h1>Tune the effect</h1>
      <div>
        <div class="color-slider" data-only-http>
          Brightness: <input data-label="BA" type="range" min="0" max="255" />
        </div>
        <div data-only-http>
          <div class="color-slider">
            Change speed:
            <input data-label="BC" type="range" min="0" max="20" />
          </div>
        </div>
        <div data-only-mqtt>
          <div class="color-slider">
            Change speed: <input data-label="BC" type="range" min="0" max="6" />
          </div>
        </div>
        <div class="color-slider">
          Color length: <input data-label="BB" type="range" min="0" max="7" />
        </div>
      </div>
    </div>

    <div id="RainMode" class="tabcontent">
      <h1>Select a predefined model</h1>
      <button
        class="text-xl w-1/4 h-8 text-black"
        onclick="pixels.sendCommand('BB4,17,1,7,10,0,BK0,128,9')"
      >
        Green christmas
      </button>
      <button
        class="text-xl w-1/4 h-8 text-black"
        onclick="pixels.sendCommand('BB4,17,1,7,10,0,BK255,255,255')"
      >
        White christmas
      </button>
      <button
        class="text-xl w-1/4 h-8 text-black"
        onclick="pixels.sendCommand('BB4,17,1,1,1,0,BK0,17,255')"
      >
        Blue
      </button>
      <button
        class="text-xl w-1/4 h-8 text-black"
        onclick="pixels.sendCommand('BB5,20,1,0,10,6,BK255,255,255')"
      >
        White flash
      </button>

      <h1>Custom</h1>
      <div data-only-http>
        Color:
        <select data-label="BE">
          <option value="0">Fixed</option>
          <option value="1">Orangish</option>
          <option value="2">Random orangish</option>
          <option value="3">Geenish</option>
          <option value="4">Random greenish</option>
          <option value="5">Violetish</option>
          <option value="6">Random violetish</option>
          <option value="7">Rainbow</option>
          <option value="8">Random rainbow</option>
          <option value="9">Random</option>
          <option value="16">Black</option>
          <option value="17">Red</option>
          <option value="18">Green</option>
          <option value="19">Yellow</option>
          <option value="20">Blue</option>
          <option value="21">Violet</option>
          <option value="22">Cyan</option>
          <option value="23">White</option>
        </select>
      </div>
      <div data-only-mqtt>
        <div
          class="color-button random-orangish"
          onclick="pixels.sendCommand('BE2')"
        >
          Orangish
        </div>
        <div
          class="color-button random-greenish"
          onclick="pixels.sendCommand('BE4')"
        >
          Greenish
        </div>
        <div
          class="color-button random-violetish"
          onclick="pixels.sendCommand('BE6')"
        >
          Violetish
        </div>
        <div class="color-button rainbow" onclick="pixels.sendCommand('BE7')">
          Rainbow
        </div>
        <div class="color-button random" onclick="pixels.sendCommand('BE9')">
          Random
        </div>
        <div class="color-button red" onclick="pixels.sendCommand('BE17')">
          Red
        </div>
        <div class="color-button green" onclick="pixels.sendCommand('BE18')">
          Green
        </div>
        <div class="color-button yellow" onclick="pixels.sendCommand('BE19')">
          Yellow
        </div>
        <div class="color-button blue" onclick="pixels.sendCommand('BE20')">
          Blue
        </div>
        <div class="color-button violet" onclick="pixels.sendCommand('BE21')">
          Violet
        </div>
        <div class="color-button cyan" onclick="pixels.sendCommand('BE22')">
          Cyan
        </div>
        <div class="color-button white" onclick="pixels.sendCommand('BE23')">
          White
        </div>
      </div>

      <div class="color-slider" data-only-http>
        Brightness:
        <input data-label="BA" type="range" min="0" max="255" />
      </div>
      If not fixed:<br />
      <div class="color-slider">Color change speed:
        <input data-label="BF" type="range" min="0" max="10" /><br /></div>
      <div class="color-slider">Fading speed:
        <input data-label="BG" type="range" min="0" max="9" /><br /></div>
      Other options:<br />
      <div class="color-slider">Number of events:
        <input data-label="BB" type="range" min="0" max="7" /><br /></div>
      <div class="color-slider">Speed:
        <input data-label="BC" type="range" min="0" max="20" /><br /></div>
      <div class="color-slider">Background:
        <div data-only-mqtt>
          <div
            class="color-square black"
            onclick="pixels.sendCommand('BK0,0,0,0')"
          ></div>
          <div
            class="color-square red"
            onclick="pixels.sendCommand('BK255,0,0')"
          ></div>
          <div
            class="color-square green"
            onclick="pixels.sendCommand('BK0,255,0')"
          ></div>
          <div
            class="color-square blue"
            onclick="pixels.sendCommand('BK0,0,255')"
          ></div>
          <div
            class="color-square yellow"
            onclick="pixels.sendCommand('BK255,255,0')"
          ></div>
          <div
            class="color-square violet"
            onclick="pixels.sendCommand('BK255,0,255')"
          ></div>
          <div
            class="color-square cyan"
            onclick="pixels.sendCommand('BK0,255,255')"
          ></div>
          <div
            class="color-square white"
            onclick="pixels.sendCommand('BK255,255,255')"
          ></div>
          <div data-only-http>
            <input type="color" data-rgb="true" data-label="BK,BL,BM" /><br />
          </div>
        </div></div>

      
      <div class="color-slider" data-only-http>
        Background brightness:
        <input data-label="BH" type="range" min="0" max="255" />
      </div>
    </div>

    <div id="CometMode" class="tabcontent">
      <h1>Presets</h1>
      <button
        class="text-xl w-1/4 h-8 text-black"
        onclick="pixels.sendCommand('BB2,20,3,9,4,6,BK255,255,255')"
      >
        Both
      </button>
      <button
        class="text-xl w-1/4 h-8 text-black"
        onclick="pixels.sendCommand('BB3,18,3,7,5,6,BK0,255,17')"
      >
        Green background
      </button>

      <h1>Advanced</h1>
      <div class="color-slider">
        Brightness:
        <input
          data-label="BA"
          type="range"
          oninput="pixels.sendSlowlyCommand('BA'+value)"
          min="0"
          max="255"
        />
      </div>
      <div class="color-slider" data-only-http>
        Color:
        <select data-label="BE" onchange="pixels.sendCommand('BE'+this.value)">
          <option value="0">Fixed</option>
          <option value="1">Orangish</option>
          <option value="2">Random orangish</option>
          <option value="3">Geenish</option>
          <option value="4">Random greenish</option>
          <option value="5">Violetish</option>
          <option value="6">Random violetish</option>
          <option value="7">Rainbow</option>
          <option value="8">Random rainbow</option>
          <option value="9">Random</option>
          <option value="16">Black</option>
          <option value="17">Red</option>
          <option value="18">Green</option>
          <option value="19">Yellow</option>
          <option value="20">Blue</option>
          <option value="21">Violet</option>
          <option value="22">Cyan</option>
          <option value="23">White</option>
        </select>
      </div>
      <div data-only-mqtt>
        <div
          class="color-button random-orangish"
          onclick="pixels.sendCommand('BE2')"
        >
          Orangish
        </div>
        <div
          class="color-button random-greenish"
          onclick="pixels.sendCommand('BE4')"
        >
          Greenish
        </div>
        <div
          class="color-button random-violetish"
          onclick="pixels.sendCommand('BE6')"
        >
          Violetish
        </div>
        <div class="color-button random" onclick="pixels.sendCommand('BE9')">
          Random
        </div>
        <div class="color-button rainbow" onclick="pixels.sendCommand('BE7')">
          Rainbow
        </div>
        <div class="color-button red" onclick="pixels.sendCommand('BE17')">
          Red
        </div>
        <div class="color-button green" onclick="pixels.sendCommand('BE18')">
          Green
        </div>
        <div class="color-button yellow" onclick="pixels.sendCommand('BE19')">
          Yellow
        </div>
        <div class="color-button blue" onclick="pixels.sendCommand('BE20')">
          Blue
        </div>
        <div class="color-button violet" onclick="pixels.sendCommand('BE21')">
          Violet
        </div>
        <div class="color-button cyan" onclick="pixels.sendCommand('BE22')">
          Cyan
        </div>
        <div class="color-button white" onclick="pixels.sendCommand('BE23')">
          White
        </div>
      </div>

      If not fixed:<br />
      <div class="color-slider">Color change speed:
        <input data-label="BF" type="range" min="0" max="10" /><br /></div>
      <div class="color-slider">speed: <input data-label="BG" type="range" min="0" max="9" /><br /></div> 
      Other options:<br />
      <div class="color-slider">Number of events:
        <input data-label="BB" type="range" min="0" max="7" /><br /></div>
      <div class="color-slider">Speed: <input data-label="BC" type="range" min="0" max="20" /><br /></div>
      <div class="color-slider">Direction:
        <select data-label="BO">
          <option value="1">From left to right</option>
          <option value="2">From right to left</option>
          <option value="5">Horizontal</option></select
        ><br /></div>
      <div class="color-slider">Background:<br />
        <div data-only-mqtt>
          <div
            class="color-square black"
            onclick="pixels.sendCommand('BK0,0,0,0')"
          ></div>
          <div
            class="color-square red"
            onclick="pixels.sendCommand('BK255,0,0')"
          ></div>
          <div
            class="color-square green"
            onclick="pixels.sendCommand('BK0,255,0')"
          ></div>
          <div
            class="color-square blue"
            onclick="pixels.sendCommand('BK0,0,255')"
          ></div>
          <div
            class="color-square yellow"
            onclick="pixels.sendCommand('BK255,255,0')"
          ></div>
          <div
            class="color-square violet"
            onclick="pixels.sendCommand('BK255,0,255')"
          ></div>
          <div
            class="color-square cyan"
            onclick="pixels.sendCommand('BK0,255,255')"
          ></div>
          <div
            class="color-square white"
            onclick="pixels.sendCommand('BK255,255,255')"
          ></div>
        </div>
        <div data-only-http>
          <input type="color" data-rgb="true" data-label="BK,BL,BM" /><br />
        </div></div>
      <div class="color-slider" data-only-http>
        Background Brightness:
        <input
          data-label="BH"
          type="range"
          oninput="pixels.sendSlowlyCommand('BH'+value)"
          min="0"
          max="255"
        />
      </div>
    </div>

    <div id="Disco" class="tabcontent">
      <div style="display: flex; flex-wrap: wrap">
        <button
          class="text-xl w-1/4 h-8 text-black"
          onclick="pixels.sendCommand('BB7,19,1,7,10,8,0,1,800,127,63,0,0,1')"
        >
          Rain fast
        </button>
        <button
          class="text-xl w-1/4 h-8 text-black"
          onclick="pixels.sendCommand('BB7,19,1,7,10,7,0,1,800,127,63,0,0,1')"
        >
          Rain medium
        </button>
        <button
          class="text-xl w-1/4 h-8 text-black"
          onclick="pixels.sendCommand('BB7,0,1,7,10,3,0,1,800,127,63,0,0,1')"
        >
          Rain slow
        </button>
        <button
          class="text-xl w-1/4 h-8 text-black"
          onclick="pixels.sendCommand('BB4,20,11,7,10,7,0,1,800,127,63,0,0,1')"
        >
          Color line slow
        </button>
        <button
          class="text-xl w-1/4 h-8 text-black"
          onclick="pixels.sendCommand('BB4,20,11,7,10,7,0,1,800,127,63,0,0,1')"
        >
          Line up down
        </button>
        <button
          class="text-xl w-1/4 h-8 text-black"
          onclick="pixels.sendCommand('BB2,20,11,0,10,6,0,1,800,255,255,255,0,1')"
        >
          Color line fast
        </button>
        <button
          class="text-xl w-1/4 h-8 text-black"
          onclick="pixels.sendCommand('BB7,20,1,0,10,9,0,1,800,255,255,255,0,1')"
        >
          Strobe fast
        </button>
        <button
          class="text-xl w-1/4 h-8 text-black"
          onclick="pixels.sendCommand('BB7,19,1,0,10,8,0,1,800,255,255,255,0,1')"
        >
          Strobe medium
        </button>
        <button
          class="text-xl w-1/4 h-8 text-black"
          onclick="pixels.sendCommand('BB7,16,1,0,10,6,0,1,800,255,255,255,0,1')"
        >
          Strobe slow
        </button>
        <button
          class="text-xl w-1/4 h-8 text-black"
          onclick="pixels.sendCommand('BA63,1,1,11,1,1,0,8,1,800,0,17,255,0,1')"
        >
          Rainbow
        </button>
      </div>
    </div>

    <div id="Advanced" class="tabcontent">
      Nb rows:
      <input data-label="BI" type="number" min="0" max="255" /><br />
      Nb led per rows:
      <input data-label="BJ" type="number" min="0" max="255" /><br />
      <button
        class="border-2 border-black"
        onmousedown="pixels.sendCommand('h')"
      >
        Help
      </button>
      <button
        class="border-2 border-black"
        onmousedown="pixels.sendCommand('s')"
      >
        Settings
      </button>
      <button
        class="border-2 border-black"
        onmousedown="pixels.getCurrentSettings()"
      >
        Current settings
      </button>
      <button class="border-2 border-black" onmousedown="pixels.getSchedule()">
        Schedule
      </button>
      <button
        class="border-2 border-black"
        onmousedown="pixels.getCurrentLineColor()"
      >
        Current line color
      </button>
      <h1>Advanced</h1>
      <form>
        <input type="text" class="border-2 border-black" name="command" />
        <input
          type="submit"
          onclick="event.preventDefault(); pixels.sendCommand(this.form.command.value);"
        />
      </form>
      <textarea class="border-2 border-black" id="result" rows="10" cols="40">
      </textarea>
      <pre>
CA: NEO_RGB: 6 - NEO_GRB: 82
CB: 1 day, 2 night, 3 day+night
CC: Sunset offset
CD: Sunrise offset
CE,CF,CG,CH,CI,CJ,CK,CL: Minute event. &lt;0 no action, minutes + intensity (0 to 15) * 2000
     </pre
      >
    </div>

    <script type="module">
      import { Pixels } from "./pixels.js";
      const pixels = new Pixels();
      window.pixels = pixels;
      const parameters = await pixels.getParameters();

      const models = [
        [0x000, 0x000, 0x000, 0x000, 0x000, 0x000, 0x000, 0x000],
        [0xfff, 0xfff, 0xfff, 0xfff, 0xfff, 0xfff, 0xfff, 0xfff],
        [0xf00, 0xf00, 0xf00, 0xf00, 0xf00, 0xf00, 0xf00, 0xf00],
        [0x0f0, 0x0f0, 0x0f0, 0x0f0, 0x0f0, 0x0f0, 0x0f0, 0x0f0],
        [0x00f, 0x00f, 0x00f, 0x00f, 0x00f, 0x00f, 0x00f, 0x00f],
        [0xf0f, 0xf0f, 0xf0f, 0xf0f, 0xf0f, 0xf0f, 0xf0f, 0xf0f],
        [0x0ff, 0x0ff, 0x0ff, 0x0ff, 0x0ff, 0x0ff, 0x0ff, 0x0ff],
        [0xff0, 0xff0, 0xff0, 0xff0, 0xff0, 0xff0, 0xff0, 0xff0],
        [0x00f, 0x00f, 0x00f, 0x00f, 0xf00, 0xf00, 0xf00, 0xf00],
        [0x0f0, 0x00f, 0x00f, 0x00f, 0xf00, 0xf00, 0xf00, 0x0f0],
        [0xf70, 0xf00, 0xf00, 0xfff, 0xf10, 0xf00, 0xf40, 0xf60],
        [0xf70, 0xf00, 0xf00, 0x000, 0xf10, 0xf00, 0xfd0, 0xf60],
        [0x01f, 0x08f, 0x04f, 0xfff, 0x0ef, 0xfff, 0x09f, 0x00f],
        [0x0f1, 0x0f0, 0xf00, 0x0f5, 0x0f0, 0xf00, 0xfff, 0xf00],
        [0xf00, 0xf0f, 0x20f, 0x0af, 0x0fb, 0x6f0, 0xfd0, 0xf70],
        [0xf00, 0xf0f, 0xf0f, 0x50f, 0x80f, 0x90f, 0xe0f, 0xf0c],
      ];
      pixels.addColorModelsButtons(models);

      // need to find the one with the right data-command
      const bd = parameters.find((p) => p.code === "BD") || { value: 1 };
      const element = document.querySelector(
        '[data-program="BD' + bd.value + '"]'
      );
      element?.click();
    </script>
  </body>
</html>
